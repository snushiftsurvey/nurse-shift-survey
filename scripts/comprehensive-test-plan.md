# 🧪 Admin-설문 웹 세션 분리 강력 테스트 계획

## 준비 단계

### 1. 개발 환경 설정
```bash
npm run dev
# 또는
yarn dev
```

### 2. 브라우저 설정
- Chrome/Edge 개발자 도구 열기 (F12)
- Network 탭에서 "Preserve log" 체크
- Console 탭에서 monitoring 스크립트 실행

## 테스트 시나리오

### 🎯 시나리오 1: 기본 세션 독립성 테스트

**단계:**
1. **설문 탭** (`localhost:3000`) 에서 설문 시작
2. 개인정보, 근무유형 등 일부 작성 (임시저장 상태로 유지)
3. **새 탭**에서 Admin 로그인 (`localhost:3000/admin`)
4. Admin 대시보드에서 여러 작업 수행
5. Admin 로그아웃
6. **설문 탭으로 돌아가서** 데이터 유지 확인

**확인 포인트:**
- [ ] 설문 진행 상태 보존
- [ ] 임시저장 데이터 유지  
- [ ] Admin 로그인/로그아웃이 설문에 영향 없음

---

### 🎯 시나리오 2: 토큰 에러 복구 테스트

**단계:**
1. Admin 대시보드 로그인 상태에서
2. 개발자 도구 Console에서 `corruptRefreshToken()` 실행
3. Admin에서 데이터 새로고침 버튼 클릭
4. 에러 발생 확인 및 복구 과정 관찰
5. 새로 로그인 시도

**확인 포인트:**
- [ ] "Invalid Refresh Token" 에러 감지
- [ ] 자동 세션 정리 작동
- [ ] 로그인 페이지로 정상 리다이렉트
- [ ] 재로그인 성공

---

### 🎯 시나리오 3: 동시 접속 충돌 테스트

**단계:**
1. **일반 탭**: 설문 작성 시작
2. **Admin 탭**: Admin 로그인
3. **시크릿 탭**: 새로운 설문 작성 시작
4. 각 탭에서 동시에 활동 수행
5. 각 탭의 localStorage 상태 비교

**확인 포인트:**
- [ ] 각 세션이 독립적으로 동작
- [ ] Cross-tab 간섭 없음
- [ ] 데이터 유실 없음

---

### 🎯 시나리오 4: 네트워크 에러 시뮬레이션

**단계:**
1. Admin 대시보드 진입
2. 개발자 도구 Network 탭에서 "Offline" 체크
3. 데이터 새로고침 시도
4. 에러 메시지 확인
5. "Offline" 해제 후 복구 확인

**확인 포인트:**
- [ ] 네트워크 에러 적절한 처리
- [ ] 사용자 친화적 에러 메시지
- [ ] 네트워크 복구 후 정상 동작

---

### 🎯 시나리오 5: 메모리 누수 및 성능 테스트

**단계:**
1. Admin 로그인/로그아웃을 10회 반복
2. 브라우저 Memory 탭에서 메모리 사용량 확인
3. 설문 작성/취소를 10회 반복  
4. 전체적인 성능 저하 확인

**확인 포인트:**
- [ ] 메모리 누수 없음
- [ ] 성능 저하 없음
- [ ] DOM 노드 정리 정상

## 모니터링 도구

### 1. Console 로깅 확인
```
🧹 Admin 로그인 페이지 - Admin 세션만 정리 시작
✅ Admin 세션 정리 완료 (설문 웹 데이터 보존)
🔐 Admin 로그인 시도 시작
✅ 로그인 성공: [user-id]
```

### 2. Network 탭 확인
- Supabase API 호출 패턴
- 401/403 에러 발생 여부
- 토큰 갱신 요청 확인

### 3. Application 탭 확인
- localStorage 변화 추적
- Session Storage 상태
- Cookies 변화

## 예상 결과

### ✅ 정상 동작
- Admin과 설문 웹 완전 독립
- 에러 시 적절한 복구
- 사용자 데이터 보존

### ❌ 문제 발생 시
- 로그 메시지로 원인 파악
- 스택 트레이스 분석
- 추가 디버깅 필요

## 추가 테스트 도구

### Supabase 대시보드 모니터링
- Auth 사용자 상태 실시간 확인
- API 호출 로그 확인
- Database 연결 상태 모니터링
